<style>
    .stores_div p, .gs_text {
        color:#6d6e71;
        font-family:lora-regular;
        /*font-family: neuton \9;*/
        font-size:14pt;
        line-height:26pt;
    }
    .stores_div{
        padding-top:30px;
        padding-left:0;
        color:#6d6e71;
        font-family:lora-regular;
        /*font-family: neuton \9;*/
        font-size:14pt;
        line-height:26pt;
    }
    .stores_div p{
        height:auto;
        border-top:none;
    }
    .socialize_div {
        margin-top:80px;
    }
    .socialize_text{
        margin-top:5px;
        
    }
    .socialize_social_icons{
        margin-top:0;
    }
    
    @media (max-width: 767px) {
        .stores_div p, .cat_div{
            padding-left:15px;
            padding-right:15px;
        }
        .cat_div{
            font-size:18pt;
            height:auto;
        }
        .list_icon{
            font-size:15px !important;
        }
    }
    
    
</style>

<div id="page_banner">
    <div class="banner_wrapper">
        <h1 class="page_headline"><span>Getting</span> Here</h1>
        <p class="page_subtitle">It's easy to get here; in the center of the shopping and business district</p>
        <div class="missing_out_div">
            <p onclick="javascript:toggle_news_form()">Fear of missing out?<i id="fear_caret" class="fa fa-caret-down"></i></p>
            <div class="hidden_newsletter_form">
                <form style="font-size:12px" id="banner_newsletter">
                    <span><input id="banner_email" name="cm-iixuu-iixuu" type="email" required  placeholder="Email address"/><button type="submit" id="banner_submit">Subscribe</button></span><br>
                            <input id="banner_agree_terms" type="checkbox" required value="I agree to receive newsletters from The Bay Centre"><label for="banner_aggree_terms" class="checkbox_lbl">I agree to receive newsletters from The Bay Centre</label>
                            
                             <input type="hidden" name="cm-f-jhtykd" id ="banner_source" />
                             <input type="hidden" name="cm-f-jhtykh" id="banner_terms"/>
                </form>
            </div>
        </div>
    </div>
</div>
<div class="share_this_icon_div">
    <span class='st_sharethis'></span>   
</div>

<div id="main_container">
    <div id="page_content"> 
        <div class="main_content_div">
            <p class="gs_text" style="margin-top:61px;margin-left:35px;margin-right:15px">
                <p class="gs_text" style="margin-top:61px;margin-left:35px;margin-right:15px"><strong><img src="//codecloud.cdn.speedyrails.net/sites/556628266e6f640eb3000000/ae788a0d586c414fe1209f4b0056bc1e/Screen Shot 2015-07-17 at 12.34.57 PM.png" align="right" style="PADDING-LEFT: 10px">Streamline your gift giving; simplify life with a Bay Centre gift card</strong>&nbsp;- available in any denomination from $10 to $500, are attractively packaged and have no initial administration fees (maintenance fees may apply). Just visit our Guest Services Centre, load up your Bay Centre gift card and start shopping! Why restrict a gift idea to a single store when The Bay Centre gift card can offer so much more?</p>
                
                <p class="gs_text" style="margin-top:20px;margin-left:35px;margin-right:15px">The Bay Centre gift card is redeemable at over 90 stores. To purchase your Bay Centre gift card, or for more information visit Guest Services, located on the lower level near the escalators.</p>
                
                <p class="gs_text" style="margin-top:20px;margin-left:35px;margin-right:15px">Please be advised that at The Bay Centre the following stores DO NOT accept the&nbsp;<strong>gift cards</strong>&nbsp;at this time:</p>
                
                <ul class="gs_text" style="margin-top:20px;margin-left:35px;margin-right:15px">
                	<li>Bayshore Dental</li>
                	<li>BC Lottery Centre</li>
                	<li>Edo Japan</li>
                	<li>Guest Services</li>
                	<li>Sizzling Wok</li>
                </ul>

                <p class="gs_text" style="margin-top:20px;margin-left:35px;margin-right:15px">Already have a Bay Centre gift card? Check your balance online at&nbsp;<a href="https://www.getmybalance.com" target="_blank">www.getmybalance.com</a>.</p>

                <div class="cat_stores_container" id="cat_stores_container">
                    <script id="cat_stores_template" type="x-tmpl-mustache/text">
                        <div class="cat_div" id="cat_{{slug}}" onclick="javascript:show_stores('{{slug}}')">
                            {{title}}
                            <i id="icon_{{slug}}" class="fa fa-plus list_icon"></i>
                        </div>
                        <div class="stores_div" id="cat_{{slug}}_stores">
                        {{{body}}}
                        </div>
                    </script>
                </div>
            </p>
        </div>        
    </div>
</div>

<script>
    $("#left_image").attr("src", "//codecloud.cdn.speedyrails.net/sites/556628266e6f640eb3000000/ae788a0d586c414fe1209f4b0056bc1e/GiftCardLeft.png");
    $("#right_image").attr("src", "//codecloud.cdn.speedyrails.net/sites/556628266e6f640eb3000000/ae788a0d586c414fe1209f4b0056bc1e/GiftCardRight.png");
    $("#main_image").attr("src", "//codecloud.cdn.speedyrails.net/sites/556628266e6f640eb3000000/cb352a97fa23d93dc26777dbd32efa33/Gift_Cards.png");
    
    function show_stores(id){
       if ($("#cat_"+id+"_stores").is(":visible")){
           $("#cat_"+id+"_stores").slideUp();
           $("#icon_"+id).removeClass("fa-minus")
           $("#icon_"+id).addClass("fa-plus")
       } else {
           $("#cat_"+id+"_stores").slideDown();
           $("#icon_"+id).removeClass("fa-plus")
           $("#icon_"+id).addClass("fa-minus")
       }
    }
    
    
    function load_slider(slider){
            
        $('.'+slider).flexslider({
                animation: "slide",
                controlNav: false,
                directionNav: true,    
                animationLoop: true,
                slideshow: true,
                minItems: 3,
                maxItems: 3,
                prevText: "",
                nextText: "",
                after:function(){
                    var active_rel = $(this).find('.flex-active-slide').attr('rel');
                    //do something
                    var first = $("#banner_slider_ul").children(":first")
                    // console.log($("#banner_slider_ul").children().length)
                    if ($("#banner_slider_ul").children().length < 6){
                        $("#banner_slider_ul").append(first.clone())
                    }
                    // $("#banner_slider_ul").append(first.clone())
                }
            });
        }
    
    
    $(document).ready(function() {
        
        function renderAll(){
            banners = []
            
            banners.push("//codecloud.cdn.speedyrails.net/sites/556628266e6f640eb3000000/cb352a97fa23d93dc26777dbd32efa33/Gift_Cards.png")
            banners.push("//codecloud.cdn.speedyrails.net/sites/556628266e6f640eb3000000/ed84014fb10de3731d4a758a6e33795e/Gift_CardsRIGHT.jpg");
            banners.push("//codecloud.cdn.speedyrails.net/sites/556628266e6f640eb3000000/ed84014fb10de3731d4a758a6e33795e/Gift_CardsLEFT.jpg");
            banner_array = []
            $.each( banners , function( key, val ) {
                var obj = {};
                obj["image_url"] = val;
                banner_array.push(obj)
            })
            
            renderBanners("#banner_slider_ul","#banner_slider_template",banner_array)
            
            
            var prefix = get_prefix();
            var page_array = [""]
            page_array = page_array.reverse()
            full_page_array = []
            $.ajaxSetup({
                async: false
            });
            $.each( page_array , function( key, val ) {
                
                var pages_json = prefix+"/pages/" + val + ".json"
                $.getJSON(pages_json).then(function(data) {
                    //var pages_data = JSON.parse(data);
                    // console.log(data.body);
                    // $("#page_title").html(data.title)
                    // $('#mm_page_content').html(data.body);
                    add_to_page_array (data)
                })
                
                
                
            })
            
            $.ajaxSetup({
                async: true
            });
            
            renderPageData("#cat_stores_container","#cat_stores_template",full_page_array, "pages")
            
            $(".loading_overlay").hide();
            $("#page_content").show();
            load_slider("flexslider4");
            
        }
        
        function renderBanners(container, template, collection){
            var item_list = [];
            var item_rendered = [];
            var template_html = $(template).html();
            Mustache.parse(template_html);   // optional, speeds up future uses
            
            $.each( collection , function( key, val ) {
                var rendered = Mustache.render(template_html,val);
                item_rendered.push(rendered);
            });
            
            $(container).show();
            $(container).html(item_rendered.join(''));
            
        }
        
        function add_to_page_array (data){
            full_page_array.push(data)
        }
        
        
        
        function renderPageData(container, template, collection, type){
            var item_list = [];
            var item_rendered = [];
            var template_html = $(template).html();
            Mustache.parse(template_html);   // optional, speeds up future uses
            $.each( collection , function( key, val ) {
                
                var title = val.title.split(" - ");
                val.title = title[1]
                
                var rendered = Mustache.render(template_html,val);
                item_rendered.push(rendered);
    
            });
            
            $(container).show();
            $(container).html(item_rendered.join(''));
        };
        
        loadMallDataCached(renderAll); 
    })
</script>