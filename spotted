<style>
    #lightbox .modal-content {
    display: inline-block;
    text-align: center;   
}

#lightbox .close {
    opacity: 1;
    color: gray;
    background-color: white;
    padding-top:3px;
    padding-bottom:5px;
    border-radius: 30px;
   border: 3px solid rgba(205, 201, 201, 0.5);
    position: absolute;
    width:37px;
    right:-56px;
    z-index:1032;
}

.modal-dialog .modal-content {
    border: 6px solid rgba(255, 255, 255, 0.5);
}
.thums-spotted{
    height: 210px;
    margin: 10px 10px 5px 0;
    width: 160px;
    float:left;
}
.thums-spotted img{
    max-height: 200px;
    max-width: 150px;
}
.spotted-title{
      color: #42245e;
    font-family: "AnneBonny-SemiBoldItalic";
    font-size: 18px;
    font-weight: 100;
    line-height: 1.42857;
    display:inline;
}
.modal-footer{
    text-align:center;
}
.spotted-description{
      color: #4d4d4f;
    display: block;
    font-family: "Maven Pro",Helvetica,Arial,sans-serif;
    font-size: 15px;
    line-height: 1.42857;
    margin-bottom: 5px;
}
@media(max-width:767px){
    .thums-spotted img{
        max-height: 150px;
        max-width: 120px;
    }
    .thums-spotted{
        height: 170px;
        margin: 10px 15px 5px 0;
        width: 130px;
        float:left;
    }
    #lightbox{
        width:320px !important;
        
    }
    .modal-dialog{
        width:245px;
    }
    #lightbox .modal-content{
        width: 300px !important;
    }
    .modal-content{
        width:300px !important;
    }
    .spotted{
        width:250px !important;
    }
}
</style>
<style>
    .row{
    }
    .col-md-3{
        float:left;
        width:calc(25% - 20px);
        margin:10px;
    }
    .thumbnail{
        display: block;
        padding: 10px;
        border: 1px solid #ccc;
    }
    .width_100{
        width:100%;
    }
    .clearfix{
        clear:both;
    }
</style>

<h3 class="contact_title">Spotted</h3>
<p class="contact_number">
    Great personal style stands out from the crowd. Our roving fashion-watchers make sure of it.
</p>
<div class="row">
    <div id="spotted_container">
        <script id="spotted_template" type="x-tmpl-mustache">
            <div class="col-md-3">
                <a href="#" class="thumbnail" data-toggle="modal" data-target="#lightbox" onclick="spottedLightbox(this)"> 
                    <img src="{{photo_url_abs}}" alt="{{description}}" title="{{name}}" class="width_100" >
                </a>
            </div>
        </script>
    </div>
    <div class="clearfix"></div>
</div>
<div id="lightbox" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true">
    <div class="modal-dialog" id="modal-dialog">
        <button type="button" class="close " data-dismiss="modal" aria-hidden="true">Ã—</button>
        <div class="modal-content">
            <div class="modal-body">
                <img class="spotted" src="" alt="..." title=""/>
            </div>
            <div class="modal-footer">
                <span class="spotted-title"></span>
                 <span class="spotted-description"></span>
            </div>
        </div>
    </div>
</div>

<script>
    $(document).ready(function() {
        loadMallDataCached(renderAll); 
    })
    function renderAll(){
        var repoList = getRepoList();
        renderSpotted('#spotted_container', '#spotted_template', repoList);
        
        $(".loading_overlay").hide();
        $("#page_content").show();
    }
    function renderSpotted(container, template, repo){
        var item_list = [];
        var item_rendered = [];
        var template_html = $(template).html();
        Mustache.parse(template_html);
    
        $.each( repo , function( key, val ) {
            if( val.name == "spotted"){
                $.each( val.images , function( key, val ) {
                    item_list.push(val);
                });
            }
        });
        $.each( item_list , function( key, val ) {
            console.log(val)
            var rendered = Mustache.render(template_html,val);
            item_rendered.push(rendered);
        });
        $(container).show();
        $(container).html(item_rendered.join(''));
        
        
    }
    
    function spottedLightbox(obj){
        if( /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) || window.width <= 600) {
            var maxWidth = 330;
            var maxHeight = 330;
        }else{
            var maxWidth = 565;
            var maxHeight = 565;
        }
        
        var $lightbox = $('#lightbox');
        var $img = $(obj).find('img'), 
        src = $img.attr('src'),
        description = $img.attr('alt'),
        title = $img.attr('title'),
        
        css = {
            'maxWidth': maxWidth,
            'maxHeight': maxHeight
        };
        
        
        $lightbox.find('.spotted').attr('src', src);
        $lightbox.find('.spotted-description').text(description);
        $lightbox.find('.spotted-title').text(title)
        $lightbox.find('.spotted').css(css);
        
        
        $lightbox.on('shown.bs.modal', function (e) {
            var $img = $lightbox.find('.spotted');
            $('#modal-dialog').css({'width': $('.spotted').width()});
            $lightbox.find('.close').removeClass('hidden');
        });
       
        
       
    }
</script>