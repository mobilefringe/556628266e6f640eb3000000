<h3 class="contact_title">Spotted</h3>
<p class="contact_number">
    Great personal style stands out from the crowd. Our roving fashion-watchers make sure of it.
</p>
<div class="row">
    <div id="spotted_container">
        <script id="spotted_template" type="x-tmpl-mustache">
            <div class="col-md-3">
                <a href="#" class="thumbnail" data-toggle="modal" data-target="#lightbox" onclick="spottedLightbox(this)"> 
                    <img src="{{photo_url_abs}}" alt="{{description}}" title="{{name}}"  >
                </a>
            </div>
        </script>
    </div>
</div>
<!--<div id="lightbox" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true">-->
<!--    <div class="modal-dialog" id="modal-dialog">-->
<!--        <button type="button" class="close " data-dismiss="modal" aria-hidden="true">×</button>-->
<!--        <div class="modal-content">-->
<!--            <div class="modal-body">-->
<!--                <img class="spotted" src="" alt="..." title=""/>-->
<!--            </div>-->
<!--            <div class="modal-footer">-->
<!--                <span class="spotted-title"></span>-->
<!--                 <span class="spotted-description"></span>-->
<!--            </div>-->
<!--        </div>-->
<!--    </div>-->
<!--</div>-->

<script>
    $(document).ready(function() {
        loadMallDataCached(renderAll); 
    })
    function renderAll(){
        var repoList = getRepoList();
        renderSpotted('#spotted_container', '#spotted_template', repoList);
        
        $(".loading_overlay").hide();
        $("#page_content").show();
    }
    function renderSpotted(spotted_template, not_empty_section_id, empty_section_id,repo){
        var item_list = [];
        var sorted_list = [];
        var spotted_template_html = $(spotted_template).html();
        Mustache.parse(spotted_template_html);   // optional, speeds up future uses
    
        $.each( repo , function( key, val ) {
            if( val.name == "spotted"){
                $.each( val.images , function( key, val ) {
                    item_list.push(val);
                });
            }
        });
        item_list.sort(sortById);
        $.each( item_list , function( key, val ) {
            
            var repo_rendered = Mustache.render(spotted_template_html,val);
            sorted_list.push(repo_rendered);
        });
        
        
       // var lightBox="<div id='lightbox' class='modal fade' tabindex='-1' role='dialog' aria-labelledby='myLargeModalLabel' aria-hidden='true'><div class='modal-dialog'><button type='button' class='close hidden' data-dismiss='modal' aria-hidden='true'>×</button><div class='modal-content'><div class='modal-body'><img src='' alt='' /></div></div></div></div>";
        var a = sorted_list.join('') ;
        if(repo.length > 0){
            $(not_empty_section_id).show();
            $(empty_section_id).hide();
            $(not_empty_section_id).html(a);
        }else{
            $(not_empty_section_id).hide();
            $(empty_section_id).show();
        }
    }
</script>