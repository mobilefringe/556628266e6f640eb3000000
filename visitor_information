<style>
    .stores_div a{
        color:#3aa2d2 !important;
        font-family:lora-regular;
        /*font-family: neuton \9;*/
        font-size:14pt;
        line-height:26pt;
        text-decoration:underline;
    }
   .store_detail_content a:link {
        color:#3aa2d2 ;
        text-decoration: underline;
    }
    #CDSSCROLLINGRAVE.wide{
        width:98% !important;
    }
    #CDSSCROLLINGRAVE.border{
        border:none !important;
    }
    .stores_div p, .gs_text {
        color:#6d6e71;
        font-family:lora-regular;
        /*font-family: neuton \9;*/
        font-size:14pt;
        line-height:26pt;
    }
    .stores_div{
        padding-top:30px;
        padding-left:0;
        color:#6d6e71;
        font-family:lora-regular;
        /*font-family: neuton \9;*/
        font-size:14pt;
        line-height:26pt;
    }
    .stores_div p{
        height:auto;
        border-top:none;
    }
    .socialize_div {
        margin-top:80px;
    }
    .socialize_text{
        margin-top:5px;
        
    }
    .socialize_social_icons{
        margin-top:0;
    }
    .tab {
        margin-top: 0px;
        width: 100%;
        background: white;
        list-style-type: initial !important;
        display: list-item !important;
    }
    .stores_div ul li{
        list-style-type: initial !important;
        display: list-item !important;
    }
    .store_detail_description{
        margin-top:15px;
        color:#6d6e71 !important;
        font-family:lora-regular;
        /*font-family: neuton \9;*/ 
        font-size:14pt;
        line-height:26pt;
    }
    .store_detail_content{
        margin-bottom:0;
        border-bottom:none;
        padding-bottom:0;
        margin-top:0;
    }
    .socialize_div {
        margin-top:80px;
    }
    .socialize_text{
        margin-top:5px;
        
    }
    .socialize_social_icons{
        margin-top:0;
    }
    
    .tabs{
        width:100%;
        background:transparent;
    }
    .tabs li{
        width:50%;
        position:relative;
        bottom:-1px;
    }
    .tab_item{
        border:none;
    }
    .tab_content{
        height:auto;
        /*margin-left:39px;*/
        /*margin-right:34px;*/
    }
    .detail_left_div{
        width:100%;
    }
    
    @media (max-width: 767px) {
        .hours_day, .hours_time {
            font-size:12pt;
        }    
        
        
        .tab_item{
            height:25px;
            color:black !important;
            padding-left:0px !important;
        }
        
       .stores_div p, .cat_div{
            padding-left:15px;
            padding-right:15px;
        }
        
        .stores_div a {
        margin-right: 0px;
        height:auto;
        }
        
        .cat_div{
            font-size:18pt;
            height:auto;
        }
        .list_icon{
            font-size:15px !important;
        }
    }
</style>

<div id="page_banner">
    <div class="banner_wrapper">
        <h1 class="page_headline"><span>Visitor</span> Information</h1>
        <p class="page_subtitle">You've done the "must sees", now do the "must shop"</p>
        <div class="missing_out_div">
            <p onclick="javascript:toggle_news_form()">Fear of missing out?<i id="fear_caret" class="fa fa-caret-down"></i></p>
            <div class="hidden_newsletter_form">
                <form style="font-size:12px" id="banner_newsletter">
                    <span>
                        <input id="banner_email" name="cm-iixuu-iixuu" type="email" required  placeholder="Email address"/>
                        <button type="submit" id="banner_submit">Subscribe</button>
                    </span>
                    <br>
                    <input id="banner_agree_terms" type="checkbox" required value="I agree to receive newsletters from The Bay Centre">
                    <label for="banner_aggree_terms" class="checkbox_lbl">I agree to receive newsletters from The Bay Centre</label>
                    <input type="hidden" name="cm-f-jhtykd" id ="banner_source" />
                    <input type="hidden" name="cm-f-jhtykh" id="banner_terms"/>
                </form>
            </div>
        </div>
    </div>
</div>

<div class="share_this_icon_div">
    <span class='st_sharethis'></span>   
</div>

<div id="main_container">
    <div id="page_content">
        <div class="tab_container">
            <ul class="tabs">
                <li id="tab_1" style="background:white">
                    <div class="tab_item" style="color:#4d4d4f">
                        Visitor Information &nbsp;&nbsp;&nbsp;&nbsp;<i class="fa fa-chevron-down"></i>
                        <div class="tab_overlay" style="display:none">&nbsp;</div>
                    </div>
                </li>
                <li id="tab_2">
                    <div class="tab_item">
                        Attractions & Accommodations &nbsp;&nbsp;&nbsp;&nbsp;<i class="fa fa-chevron-down"></i>
                        <div class="tab_overlay">&nbsp;</div>
                    </div>
                </li>
            </ul>
            <ul class="tab_content">
                <li id="tab_1_content">
                    <div class="store_detail_content">
                        <div class="detail_left_div">
                            <div class="gs_text" style="margin-top:61px;margin-left:15px;margin-right:15px">
                                <div id="TA_cdsscrollingravewide841" class="TA_cdsscrollingravewide">
                                    <ul id="Zn85DHyyAp" class="TA_links 3Rwvx3">
                                        <li id="x0TQtgkNx8V" class="3KjKcpBaDUU">
                                            <a target="_blank" href="https://www.tripadvisor.ca/"><img src="https://static.tacdn.com/img2/t4b/Stacked_TA_logo.png" alt="TripAdvisor" class="widEXCIMG" id="CDSWIDEXCLOGO"/></a>
                                        </li>
                                    </ul>
                                </div>
                                <script src="https://www.jscache.com/wejs?wtype=cdsscrollingravewide&amp;uniq=841&amp;locationId=3349451&amp;lang=en_CA&amp;border=false&amp;shadow=false&amp;display_version=2"></script>

                                <p>Come visit The Bay Centre, a &ldquo;must see&rdquo; in downtown Victoria&#39;s shopping and business district. Known for our architecture and urban atmosphere, The Bay Centre has a mix of over 90 street front and interior shops covering an entire full city block.</p>

                                <p>Conveniently located:</p>
            
                                <ul class="gs_text">
                                    <li class="tab">Across the street from the Cruise Ship shuttle stop;</li>
                                    <li class="tab">Three blocks from the Inner Harbour including the <a href="https://www.clippervacations.com/" target="_blank">Victoria Clipper</a>, <a href="https://www.cohoferry.com/" target="_blank">MV Coho</a>, <a href="https://www.harbourair.com/" target="_blank">Harbour Air</a>, <a href="https://helijet.com/" target="_blank">Helijet</a>;</li>
                                    <li class="tab">Three blocks from the world renowned <a href="https://www.fairmont.com/empress-victoria" target="_blank">Empress Hotel</a> and <a href="https://victoriaconference.com/" target="_blank">Victoria Convention Centre</a>;</li>
                                    <li class="tab">Right on the Government Street tourist walk.</li>
                                </ul>
            
                                <p>All of which positions the Centre to welcome 3.0 million out-of-town guests that visit Victoria each year.
                                    <br/><br>
                                    Featuring <a href="http://www.thebaycentre.com/stores/baycentre-club-monaco--4" target="_blank">Club Monaco</a>, <a href="http://www.thebaycentre.com/stores/baycentre-bcbgmaxazria--2" target="_blank">BCBGMAXAZRIA</a>,&nbsp; <a href="http://www.thebaycentre.com/stores/baycentre-aerosoles--2" target="_blank">Aerosoles</a>, <a href="http://www.thebaycentre.com/stores/baycentre-earls-kitchen-bar--2" target="_blank">Earls Restaurant</a>, <a href="http://www.thebaycentre.com/stores/baycentre-eco-chic-aveda-salon-spa--2" target="_blank">Eco Chic Aveda Salon &amp; Spa</a>, <a href="http://www.thebaycentre.com/stores/baycentre-goodlife-fitness--2" target="_blank">GoodLife Fitness</a>, <a href="http://www.thebaycentre.com/stores/baycentre-guess--3" target="_blank">Guess?</a>, <a href="http://www.thebaycentre.com/stores/baycentre-l-occitane-en-provence--2" target="_blank">L&#39;Occitane</a>, <a href="http://www.thebaycentre.com/stores/baycentre-my-foot-reflexology--2" target="_blank">My Foot Reflexology</a>, <a href="http://www.thebaycentre.com/stores/baycentre-sport-chek--2" target="_blank">Sport Chek</a>, <a href="http://www.thebaycentre.com/stores/baycentre-hudson-s-bay-the--2" target="_blank">Hudson&rsquo;s Bay</a>, <a href="http://www.thebaycentre.com/stores/baycentre-teavana--2" target="_blank">Teavana</a>, <a href="http://www.thebaycentre.com/stores/baycentre-the-tuscan-kitchen--2" target="_blank">The Tuscan Kitchen</a>, <a href="http://www.thebaycentre.com/stores/baycentre-urban-planet--3" target="_blank">Urban Planet</a>&nbsp;and so much more. It is no wonder why over 7 million guests visit The Bay Centre on a yearly basis.</p>

                                <p>We hope to see you soon at The Bay Centre.</p>
                            </div>
                        </div>
            
                        <div class="cat_stores_container" id="cat_stores_container">
                            <script id="cat_stores_template" type="x-tmpl-mustache/text">
                                <div class="cat_div" id="cat_{{slug}}" onclick="javascript:show_stores('{{slug}}')">
                                    {{title}}
                                    <i id="icon_{{slug}}" class="fa fa-plus list_icon"></i>
                                </div>
                                <div class="stores_div" id="cat_{{slug}}_stores">
                                    {{{body}}}
                                </div>
                            </script>
                        </div>
                    </div>
                </li>
                <li id="tab_2_content" style="display:none">
                    <div class="store_detail_content">
                        <div class="detail_left_div">
                            <p class="gs_text" style="margin-top:61px;margin-left:15px;margin-right:15px">
                            While shopping is our favourite thing to do in Victoria, there is a lot to experience while visiting the “City of Gardens.” Only a 1.5 hour ferry ride from Vancouver, Victoria is located on Vancouver Island. The Island was recently rated the Top Island in the Continental US and Canada and one of the Top Ten Islands in the World by the 2014 Travel + Leisure World's Best Awards. After visiting The Bay Centre be sure to save some time to explore everything Victoria has to offer.</p>

                            <div class="cat_stores_container" id="cat_stores_container2">
                                <script id="cat_stores_template2" type="x-tmpl-mustache/text">
                                    <div class="cat_div" id="cat_{{slug}}" onclick="javascript:show_stores('{{slug}}')">
                                        {{title}}
                                        <i id="icon_{{slug}}" class="fa fa-plus list_icon"></i>
                                    </div>
                                    <div class="stores_div" id="cat_{{slug}}_stores">
                                        {{{body}}}
                                    </div>
                                </script>
                            </div>
                        </div>
                    </div>
                </li>
            </ul>
        </div>
    </div>
</div>

<script>
    $(document).ready(function() {
        function add_to_page_array (data, array){
            array.push(data);
        }
        
        function renderAll(){
            var page_banner = getRepoDetailsByName('Visitor Information').images;
            var banner_url = "";
            $.each(page_banner, function(key, val){
                banner_url = val.photo_url_abs;
            });
            $("#page_banner").css({backgroundImage: "url(" + banner_url + ")"});
            
            var prefix = get_prefix();
            var page_array = ["baycentre-visitor-information-getting-here","baycentre-visitor-information-shop-stay-partners","baycentre-visitor-information-guest-services","baycentre-visitor-information-visitor-saving-pass"]
            var page_array2 = ["baycentre-attractions-accomodations-transportation","baycentre-attractions-accomodations-tourism","baycentre-attractions-accomodations-city-and-region","baycentre-attractions-accomodations-attractions"]
            page_array = page_array.reverse()
            page_array2 = page_array2.reverse()
            full_page_array = []
            full_page_array2 = []
            $.ajaxSetup({
                async: false
            });
            $.each(page_array, function(key, val) {
                var pages_json = prefix + "/pages/" + val + ".json"
                $.getJSON(pages_json).then(function(data) {
                    add_to_page_array(data, full_page_array);
                });
            });
            $.each(page_array2, function(key, val) {
                var pages_json = prefix + "/pages/" + val + ".json"
                $.getJSON(pages_json).then(function(data) {
                    add_to_page_array(data, full_page_array2);
                });
            });
            $.ajaxSetup({
                async: true
            });
            renderPageData("#cat_stores_container","#cat_stores_template",full_page_array, "pages")
            renderPageData("#cat_stores_container2","#cat_stores_template2",full_page_array2, "pages")
     
            $.getScript("https://cdn.jsdelivr.net/slimbox/2.0.5/js/slimbox2.js");
            $('head').append('<link rel="stylesheet" href="https://cdn.jsdelivr.net/slimbox/2.0.5/css/slimbox2.css" type="text/css" media="screen" />');
            $(".loading_overlay").hide();
            $("#page_content").show();
        }
        
        
        function renderData(container, template, collection, type){
            var item_list = [];
            var item_rendered = [];
            var template_html = $(template).html();
            Mustache.parse(template_html);   // optional, speeds up future uses
            if (type !="store_hours"){
                item_list.push(collection);
                collection = []
                collection = item_list;    
            }
            $.each( collection , function( key, val ) {
                if (type == "store_hours"){
                    switch(val.day_of_week) {
                        case 0:
                            val.day = "Sunday"
                            break;
                        case 1:
                            val.day = "Monday"
                            break;
                        case 2:
                            val.day = "Tuesday"
                            break;
                        case 3:
                            val.day = "Wednesday"
                            break;
                        case 4:
                            val.day = "Thursday"
                            break;
                        case 5:
                            val.day = "Friday"
                            break;
                        case 6:
                            val.day = "Saturday"
                            break;
                        
                    }
                    if (template == "#store_detail_hours_template1"){
                        var open_time = new Date (val.open_time)
                        var close_time = new Date (val.close_time)
                        val.open_time = convert_hour(open_time);
                        val.close_time = convert_hour(close_time);
                        if (val.is_closed == true){
                            val.hour_string = "Closed"
                        } else {
                            val.hour_string = val.open_time + " - " + val.close_time
                        }
                    } 
                } else {
                    if (val.title.indexOf(" - ") >= 0){
                        var title = val.title.split(" - ");
                        val.title = title[1]
                    } 
                    if(val.image_url.indexOf('missing.png') > -1 || val.image_url.length === 0){
                        val.page_image = "//codecloud.cdn.speedyrails.net/sites/5639075d6e6f647b9f020000/image/jpeg/1453737960000/TheBayCentre.jpg"    
                    } else {
                        val.page_image = (val.image_url);    
                    }    
                }
                var rendered = Mustache.render(template_html,val);
                item_rendered.push(rendered);
            });
            $(container).show();
            $(container).html(item_rendered.join(''));
        };
        
        function renderPageData(container, template, collection, type){
            var item_list = [];
            var item_rendered = [];
            var template_html = $(template).html();
            Mustache.parse(template_html);   // optional, speeds up future uses
            $.each( collection , function( key, val ) {
                var title = val.title.split(" - ");
                val.title = title[1]
                
                var rendered = Mustache.render(template_html,val);
                item_rendered.push(rendered);
            });
            $(container).show();
            $(container).html(item_rendered.join(''));
        };
        
        function renderpageHTML(slug, id){
            prefix = get_prefix();
            var pages_json = prefix+"/pages/" + slug + ".json"
            $.getJSON(pages_json).done(function(data) {
                if (id == 1){
                    renderData("#promo_title_container1", "#promo_title_template1", data, "title")
                    renderData("#store_detail_right_content_container1", "#store_detail_right_content_template1", data, "image") 
                } else {
                    renderData("#promo_title_container2", "#promo_title_template2", data, "title")
                    renderData("#store_detail_right_content_container2", "#store_detail_right_content_template2", data, "image")
                }
            }).fail(function(jqXHR) {
                if (jqXHR.status == 404) {
                    $("#left_image").attr("src", "//codecloud.cdn.speedyrails.net/sites/556628266e6f640eb3000000/389e126f6eee4f2c99cc11b9512c8940/404_banner3.jpg");
                    $("#right_image").attr("src", "//codecloud.cdn.speedyrails.net/sites/556628266e6f640eb3000000/389e126f6eee4f2c99cc11b9512c8940/404_banner2.jpg");
                    $("#main_image").attr("src", "//codecloud.cdn.speedyrails.net/sites/556628266e6f640eb3000000/389e126f6eee4f2c99cc11b9512c8940/404_banner1.jpg");
                }
            }); 
        }
        
        //The following was added to load trip advisor separately. there is an issue with the widget with pages where there are AJAX queries. this article explains the issue. https://stackoverflow.com/questions/19661206/tripadvisor-widget-fails-to-load-on-ajax-page-loading

    $.getScript('//www.tripadvisor.fr/WidgetEmbed-selfserveprop?nreviews=6&uniq=&iswide=true&locationId=841&rating=true&popIdx=true&border=false&writereviewlink=true&lang=fr', function() {
        if (typeof(window.taValidate) != 'undefined') {
            window.taValidate();
        }
    });

    $(".tabs li").click(function(e){
        var clicked = this.id
        $(".tabs li").css({"background":"transparent","color":"white"});
        $(".tabs li").find(".tab_overlay").css("display","block");
        $(".tabs li").find("div").css("color","white");
        $(this).css("background","white");
        $(this).find("div").css("color","#4d4d4f");
        $(this).find(".tab_overlay").css("display","none");
        $(".tab_content li").hide();
        $("#"+clicked + "_content").show()
        $("#"+clicked + "_content li").show()
    });
    
    // function show_stores(id){
    //   if ($("#cat_"+id+"_stores").is(":visible")){
    //       $("#cat_"+id+"_stores").slideUp();
    //       $("#icon_"+id).removeClass("fa-minus")
    //       $("#icon_"+id).addClass("fa-plus")
    //   } else {
    //       $("#cat_"+id+"_stores").slideDown();
    //       $("#icon_"+id).removeClass("fa-plus")
    //       $("#icon_"+id).addClass("fa-minus")
    //   }
    // }
        loadMallDataCached(renderAll);  
    });
</script>